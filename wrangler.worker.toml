# ===========================================
# CONFIGURACIÃ“N DE CLOUDFLARE WORKER (Backend API)
# ===========================================
# Este archivo configura tu backend API para Cloudflare Workers
# Usa: cd worker && npm install && cd .. && wrangler deploy -c wrangler.worker.toml

name = "runna-io-api"
account_id = "5b173ee18f2de458cbc95ab4a55ab8ba"
main = "worker/src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Variables de entorno (NO secretas)
[vars]
ENVIRONMENT = "production"
EMAIL_PROVIDER = "sendgrid"
SENDGRID_FROM = "runna.io.service@gmail.com"
RESEND_FROM = "onboarding@resend.dev"

# NOTA: Las API keys deben configurarse como secretos:
# wrangler secret put SENDGRID_API_KEY -c wrangler.worker.toml
# wrangler secret put RESEND_API_KEY -c wrangler.worker.toml
# wrangler secret put DATABASE_URL -c wrangler.worker.toml
# wrangler secret put TURSO_AUTH_TOKEN -c wrangler.worker.toml
# wrangler secret put UPSTASH_CRON_SECRET -c wrangler.worker.toml
#
# ===== Upstash Inactivity Reminders Setup =====
# 1. Create an Upstash account at https://upstash.com
# 2. Create a QStash schedule (every 12 hours):
#    - URL: https://runna-io-api.<your-subdomain>.workers.dev/api/tasks/inactivity-check
#    - Method: POST
#    - Schedule: 0 */12 * * *  (every 12 hours)
#    - Header: Authorization: Bearer <your-UPSTASH_CRON_SECRET>
# 3. Set the secret:
#    wrangler secret put UPSTASH_CRON_SECRET -c wrangler.worker.toml

# Para desplegar el Worker:
# 1. cd worker && npm install && cd ..
# 2. wrangler deploy -c wrangler.worker.toml
