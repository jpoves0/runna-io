Perfecto. Con tu experiencia en Cloudflare Pages y Workers, te presento la estrategia Ã³ptima:

## ðŸ—ï¸ Estructura de Archivos Recomendada

```
runna-io/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ client/                    # Frontend (React + Vite)
â”‚   â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”‚   â”œâ”€â”€ manifest.json     # PWA
â”‚   â”‚   â”‚   â”œâ”€â”€ service-worker.js # Service Worker
â”‚   â”‚   â”‚   â””â”€â”€ icons/            # PWA icons
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ components/
â”‚   â”‚       â”œâ”€â”€ pages/
â”‚   â”‚       â”œâ”€â”€ hooks/            # Custom hooks (GPS, maps)
â”‚   â”‚       â”œâ”€â”€ lib/
â”‚   â”‚       â””â”€â”€ App.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ server/                    # Backend (Cloudflare Workers)
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ api/              # Endpoints
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ routes.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ territories.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ users.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ schema.ts     # Drizzle ORM
â”‚   â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts          # Entry point Worker
â”‚   â”‚   â””â”€â”€ wrangler.toml         # Cloudflare Worker config
â”‚   â”‚
â”‚   â””â”€â”€ shared/
â”‚       â”œâ”€â”€ types.ts              # TypeScript interfaces
â”‚       â””â”€â”€ constants.ts
â”‚
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/                # CI/CD (opcional)
â”‚       â””â”€â”€ deploy.yml
â”‚
â””â”€â”€ package.json
```

***

## ðŸ—„ï¸ Base de Datos Recomendada: **Neon PostgreSQL**

Para tu caso, **Neon** es la mejor opciÃ³n porque:

âœ… **Gratis indefinidamente** - 3 proyectos, 10GB de almacenamiento  
âœ… **Serverless PostgreSQL** - Escalable automÃ¡ticamente  
âœ… **Compatible con Drizzle ORM** (que usas)  
âœ… **Excelente para collaborative teams** (perfecto para amigos)  
âœ… **IntegraciÃ³n directa con Cloudflare Workers**  

**Alternativas:**
- **Supabase** - Similar a Neon, pero con extras (auth, storage) - tambiÃ©n gratis
- **ElephantSQL** - MÃ¡s limitado (20MB) pero simple para MVP

### Setup Neon:

```bash
# 1. Crear cuenta en https://neon.tech

# 2. Crear base de datos
# Dashboard â†’ New Project â†’ PostgreSQL

# 3. Copiar CONNECTION STRING
# Looks like: postgresql://user:password@host/database

# 4. En wrangler.toml:
[env.production]
vars = { DATABASE_URL = "postgresql://..." }

# 5. En code:
const db = new Database(env.DATABASE_URL)
```

***

## ðŸš€ Despliegue Gratuito: **Cloudflare Pages + Workers**

Esta es tu mejor opciÃ³n porque **ya usas Cloudflare**:

### Arquitectura:
```
GitHub Repo
    â†“
Cloudflare Pages (Frontend)  â† Auto-deploy en cada push
    â†“
Cloudflare Workers (Backend) â† APIs + lÃ³gica
    â†“
Neon PostgreSQL (Database)   â† Datos
    â†“
Cloudflare KV Store (opcional) â† CachÃ© en tiempo real
```

### Setup Paso a Paso:

**1. Preparar repositorio:**
```bash
# En tu repo local
npm init -y

# package.json
{
  "name": "runna-io",
  "scripts": {
    "dev": "wrangler dev",
    "deploy": "wrangler deploy",
    "build": "vite build"
  },
  "dependencies": {
    "drizzle-orm": "latest",
    "pg": "latest",
    "hono": "latest"  # Alternativa a Express para Workers
  }
}
```

**2. Estructura wrangler.toml:**
```toml
name = "runna-io"
type = "javascript"
main = "src/server/index.ts"

[env.production]
routes = [
  { pattern = "api/*", zone_name = "tu-dominio.com" }
]
vars = { 
  DATABASE_URL = "postgresql://..." 
}

[build]
command = "npm run build"
cwd = "."
```

**3. Desplegar:**
```bash
# Instalar Wrangler
npm install -g wrangler

# Login a Cloudflare
wrangler login

# Publicar
wrangler deploy

# URL auto-generada: runna-io.your-domain.workers.dev
```

**4. Conectar GitHub para auto-deploy:**
- En Cloudflare Dashboard â†’ Pages
- Connect to Git â†’ Selecciona repo
- Build command: `npm run build`
- Output: `dist/`
- Â¡Listo! Cada push a main = deploy automÃ¡tico

***

## ðŸ“± PWA Setup (Mobile Install)

Ya estÃ¡ en tu README, pero aquÃ­ la integraciÃ³n con Workers:

```typescript
// src/server/index.ts - Servir manifest.json
router.get('/manifest.json', (c) => {
  return c.json({
    name: "Runna.io",
    short_name: "Runna",
    start_url: "/",
    display: "standalone",
    background_color: "#ffffff",
    theme_color: "#3b82f6",
    icons: [
      {
        src: "/icon-192.png",
        sizes: "192x192",
        type: "image/png",
        purpose: "any"
      },
      {
        src: "/icon-512.png",
        sizes: "512x512",
        type: "image/png",
        purpose: "maskable"
      }
    ]
  })
})
```

***

## ðŸ”‘ Variables de Entorno

```bash
# .env.local (desarrollo)
VITE_API_URL=http://localhost:8787
DATABASE_URL=postgresql://...

# wrangler.toml (producciÃ³n)
[env.production]
vars = {
  DATABASE_URL = "postgresql://..."
}
```

***

## ðŸ‘¥ Compartir con Amigos (3 Opciones)

### OpciÃ³n 1: **Dominio personalizado (Recomendado)**
```bash
# Cloudflare Dashboard
Pages â†’ runna-io â†’ Settings â†’ Domain
Conectar dominio tuyo o subdominio

# Tu amigo accede: https://runna.tu-dominio.com
```

### OpciÃ³n 2: **Usar dominio gratuito Cloudflare**
```
runna-io.pages.dev (auto-generado)
Compartir URL con amigos
```

### OpciÃ³n 3: **Usar Vercel (alternativa)**
- Similar a Cloudflare Pages
- Deploy automÃ¡tico desde GitHub
- Gratis indefinidamente

***

## ðŸŽ¯ Resumen de Costos

| Servicio | Coste | Por quÃ© |
|----------|--------|--------|
| **Cloudflare Pages** | Gratis | Hosting frontend unlimited |
| **Cloudflare Workers** | Gratis | 100k requests/dÃ­a, suficiente para MVP |
| **Neon PostgreSQL** | Gratis | 3 proyectos, 10GB, serverless |
| **Dominio** | Gratis | Usar .pages.dev o subdominio tuyo |
| **GitHub** | Gratis | Repositorio privado |
| **TOTAL** | **â‚¬0** | MVP funcional para amigos |

***

## ðŸ“Š Ejemplo MÃ­nimo (Worker + Neon)

```typescript
// src/server/index.ts
import { Hono } from 'hono'
import { drizzle } from 'drizzle-orm/postgres-js'
import postgres from 'postgres'

const app = new Hono()

export default {
  async fetch(request: Request, env: Env) {
    // Conectar a Neon
    const client = postgres(env.DATABASE_URL)
    const db = drizzle(client)
    
    // Route
    app.get('/api/territories', async (c) => {
      const territories = await db.select().from(territoriesTable)
      return c.json(territories)
    })
    
    app.post('/api/territories/claim', async (c) => {
      const { userId, coordinates } = await c.req.json()
      // LÃ³gica de reconquista
      return c.json({ success: true })
    })
    
    return app.fetch(request)
  }
}
```

***

## âœ… PrÃ³ximos Pasos

1. **Crear cuenta Neon** â†’ https://neon.tech (5 min)
2. **Configurar wrangler.toml** (5 min)
3. **Push a GitHub** (2 min)
4. **Conectar a Cloudflare Pages** (3 min)
5. **Compartir URL con amigos** âœ¨

**Â¿Necesitas ayuda con implementaciÃ³n especÃ­fica o configuraciÃ³n de Neon?** Puedo crearte un `wrangler.toml` completo o un archivo de schema Drizzle optimizado para territorios.

[1](https://codeless.co/free-postgresql-hosting/)
[2](https://dev.to/hexshift/how-to-host-a-scalable-full-stack-app-for-free-using-cloudflare-pages-workers-and-supabase-2ke5)
[3](https://penji.co/free-cloud-database/)
[4](https://formbold.com/blog/free-database-hosting)
[5](https://developers.cloudflare.com/pages/)
[6](https://appinventiv.com/blog/top-web-app-database-list/)
[7](https://www.bitcatcha.com/web-hosting/free/postgresql/)
[8](https://www.cloudflare.com/developer-platform/products/pages/)
[9](https://coredevsltd.com/articles/database-list/)
[10](https://www.pgsclusters.com/free-postgresql)